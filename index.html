<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Tirtha Suraksha</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        /* Critical inline styles for immediate rendering */
        body { margin: 0; padding: 0; width: 100%; overflow-x: hidden; }
        * { box-sizing: border-box; }
    </style>
</head>
<body>
    <!-- Top Bar -->
    <div class="top-bar">
        <div class="top-bar-content">
            <div class="top-bar-left">
                <a href="#">Skip to Main Content</a>
                <a href="#">Screen Reader Access</a>
                <a href="#">Font Size: A- | A | A+</a>
                <select id="languageSelector" onchange="changeLanguage(this.value)" style="background: transparent; color: white; border: 1px solid white; padding: 2px 5px;">
                    <option value="en">English</option>
                    <option value="hi">हिंदी</option>
                    <option value="gu">ગુજરાતી</option>
                    <option value="mr">मराठी</option>
                    <option value="ta">தமிழ்</option>
                    <option value="te">తెలుగు</option>
                </select>
            </div>
            <div class="user-section">
                <button class="login-btn" onclick="showLoginModal()">🔐 Login/Register</button>
                <div class="user-menu" id="userMenu" style="display: none;">
                    <span class="user-name">Welcome, User</span>
                    <button onclick="showProfile()">My Profile</button>
                    <button onclick="logout()">Logout</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Government Header -->
    <header class="gov-header">
        <div class="gov-header-content">
            <div class="gov-logo-section">
                <img src="ashoka.png" alt="National Emblem of India" class="gov-emblem">
                <div class="gov-titles">
                    <h1>Government of Gujarat</h1>
                    <h2>TirthaSuraksha - Safe Darshan, Smart Yatra</h2>
                    <div class="hindi">तीर्थ सुरक्षा - सुरक्षित दर्शन, स्मार्ट यात्रा</div>
                </div>
            </div>
            <div style="text-align: right;">
                <div style="font-size: 0.9rem; color: #666;">Developed by</div>
                <div style="font-weight: bold;">GUJCOST, Dept. of Science & Technology</div>
                <div style="font-size: 0.85rem; color: #666;">Last Updated: <span id="lastUpdate">22/09/2025 10:45 AM</span></div>
            </div>
        </div>
    </header>

    <!-- Main Navigation -->
    <nav class="main-nav">
        <div class="nav-container">
            <button class="mobile-menu-btn" onclick="toggleMobileMenu()">☰ Menu</button>
            <ul class="nav-menu">
                <li>
                    <a href="#home">🏠 Home</a>
                </li>
                <li>
                    <a href="#temples">⛩️ Temples</a>
                    <ul class="dropdown">
                        <li><a href="#">Somnath Temple</a></li>
                        <li><a href="#">Dwarka Temple</a></li>
                        <li><a href="#">Ambaji Temple</a></li>
                        <li><a href="#">Pavagadh Temple</a></li>
                    </ul>
                </li>
                <li>
                    <a href="#booking">🎫 E-Darshan Booking</a>
                </li>
                <li>
                    <a href="#crowd">📊 Live Crowd Status</a>
                </li>
                <li>
                    <a href="#parking">🚗 Parking Info</a>
                </li>
                <li>
                    <a href="#facilities">🏥 Facilities</a>
                    <ul class="dropdown">
                        <li><a href="#">Medical Centers</a></li>
                        <li><a href="#">Rest Rooms</a></li>
                        <li><a href="#">Food Courts</a></li>
                        <li><a href="#">Cloak Rooms</a></li>
                        <li><a href="#">Special Assistance</a></li>
                    </ul>
                </li>
                <li>
                    <a href="#emergency">🚨 Emergency</a>
                </li>
                <li>
                    <a href="#feedback">📝 Feedback</a>
                </li>
            </ul>
        </div>
    </nav>

    <!-- Mobile Menu Sidebar -->
    <div class="mobile-overlay" onclick="closeMobileMenu()"></div>
    <div class="mobile-sidebar" id="mobileSidebar">
        <div class="mobile-sidebar-header">
            <span style="font-weight: bold;">Navigation Menu</span>
            <button class="close-mobile-menu" onclick="closeMobileMenu()">×</button>
        </div>
        <ul class="sidebar-menu">
            <li><a href="#" onclick="closeMobileMenu(); showDashboard()">🏠 Home</a></li>
            <li><a href="#" onclick="closeMobileMenu(); showBooking()">🎫 E-Darshan Booking</a></li>
            <li><a href="#" onclick="closeMobileMenu(); showCrowdMap()">📊 Live Crowd Map</a></li>
            <li><a href="#" onclick="closeMobileMenu(); showQueueStatus()">⏱️ Queue Status</a></li>
            <li><a href="#" onclick="closeMobileMenu(); showParking()">🚗 Parking</a></li>
            <li><a href="#" onclick="closeMobileMenu(); showDonation()">💰 Online Donation</a></li>
            <li><a href="#" onclick="closeMobileMenu(); viewFacilities()">🏥 Facilities</a></li>
            <li><a href="#" onclick="closeMobileMenu(); specialAssistance()">♿ Special Assistance</a></li>
            <li><a href="#" onclick="closeMobileMenu(); showComplaints()">📝 Lodge Complaint</a></li>
            <li><a href="#" onclick="closeMobileMenu(); showHistory()">📜 Booking History</a></li>
            <li><a href="#" onclick="closeMobileMenu(); showGuidelines()">📋 Guidelines</a></li>
            <li><a href="#" onclick="closeMobileMenu(); showEmergency()">🚨 Emergency</a></li>
            <li><a href="#" onclick="closeMobileMenu(); showHelp()">❓ Help & Support</a></li>
        </ul>
    </div>

    <!-- Ticker -->
    <div class="ticker-wrap">
        <div class="ticker-label">LATEST</div>
        <div class="ticker">
            <span class="ticker-item">Special Darshan on Ekadashi from 4:00 AM</span>
            <span class="ticker-item">Free shuttle service from Railway Station every 15 minutes</span>
            <span class="ticker-item">Online booking mandatory for VIP darshan</span>
            <span class="ticker-item">Parking Lot B closed for maintenance on 25th Sept</span>
            <span class="ticker-item">New mobile app launched - Download from Play Store</span>
            <span class="ticker-item">Special Darshan on Ekadashi from 4:00 AM</span>
            <span class="ticker-item">Free shuttle service from Railway Station every 15 minutes</span>
        </div>
    </div>

    <!-- Main Container -->
    <div class="container">
        <div class="dashboard-grid">
            <!-- Left Sidebar -->
            <aside class="sidebar">
                <div class="sidebar-header">Quick Links</div>
                <ul class="sidebar-menu">
                    <li><a href="#" onclick="showDashboard()">Dashboard</a></li>
                    <li><a href="#" onclick="showBooking()">Book E-Darshan</a></li>
                    <li><a href="#" onclick="showCrowdMap()">Live Crowd Map</a></li>
                    <li><a href="#" onclick="showQueueStatus()">Queue Status</a></li>
                    <li><a href="#" onclick="showParking()">Parking Availability</a></li>
                    <li><a href="#" onclick="showDonation()">Online Donation</a></li>
                    <li><a href="#" onclick="showComplaints()">Lodge Complaint</a></li>
                    <li><a href="#" onclick="showHistory()">Booking History</a></li>
                    <li><a href="#" onclick="showGuidelines()">Visitor Guidelines</a></li>
                    <li><a href="#" onclick="showDownloads()">Downloads</a></li>
                    <li><a href="#" onclick="showHelp()">Help & Support</a></li>
                </ul>
            </aside>

            <!-- Main Content -->
            <main class="main-content">
                <!-- Statistics Overview -->
                <h3 style="color: var(--gov-blue); margin-bottom: 20px;">📊 Live Statistics Dashboard</h3>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">Current Devotees</div>
                        <div class="stat-number" id="currentCount">15,234</div>
                        <div class="stat-change stat-up">↑ 12% from yesterday</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-label">Average Wait Time</div>
                        <div class="stat-number" style="color: var(--gov-orange);">45 min</div>
                        <div class="stat-change stat-down">↓ 15 min from morning</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-label">Today's Footfall</div>
                        <div class="stat-number" style="color: var(--gov-green);">48,762</div>
                        <div class="stat-change">Expected: 75,000</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-label">Parking Available</div>
                        <div class="stat-number" style="color: var(--gov-red);">127</div>
                        <div class="stat-change">Out of 2,500 spots</div>
                    </div>
                </div>

                <!-- Info Widgets Row - Below Statistics -->
                <div class="info-widgets-row">
                    <!-- Live Updates Widget -->
                    <div class="widget-card">
                        <div class="widget-header-small">🔴 Live Updates</div>
                        <div class="widget-content-small">
                            <div class="live-feed-item">
                                <small>10:45 AM</small>
                                <p>Gate 3 opened for crowd management</p>
                            </div>
                            <div class="live-feed-item">
                                <small>10:30 AM</small>
                                <p>VIP darshan completed</p>
                            </div>
                            <div class="live-feed-item">
                                <small>10:15 AM</small>
                                <p>Medical team deployed at Queue Area 2</p>
                            </div>
                            <button class="btn btn-primary btn-small" onclick="showLiveCam()">📹 View Live Camera</button>
                        </div>
                    </div>
                    
                    <!-- Weather Widget -->
                    <div class="widget-card">
                        <div class="widget-header-small">🌤️ Weather Today</div>
                        <div class="widget-content-small">
                            <div style="text-align: center;">
                                <div style="font-size: 2rem; font-weight: bold;">32°C</div>
                                <div>Partly Cloudy</div>
                                <div style="font-size: 0.85rem; margin-top: 5px;">
                                    Humidity: 65% | Wind: 12 km/h | UV: 7
                                </div>
                                <small style="display: block; margin-top: 10px; color: #666;">
                                    Carry water bottles. Hydration points available.
                                </small>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Crowd Prediction Widget -->
                    <div class="widget-card">
                        <div class="widget-header-small">📊 Crowd Forecast (Next 6 Hours)</div>
                        <div class="widget-content-small">
                            <canvas id="crowdChart" width="300" height="150"></canvas>
                            <div style="margin-top: 10px; font-size: 0.85rem;">
                                <div>🟢 Best Time: 2:00 PM - 3:00 PM</div>
                                <div>🔴 Peak Expected: 5:00 PM - 7:00 PM</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Festival Calendar Widget -->
                    <div class="widget-card">
                        <div class="widget-header-small">🎉 Upcoming Festivals</div>
                        <div class="widget-content-small">
                            <div class="festival-list">
                                <div class="festival-item">
                                    <span>🕉️ Mahashivratri</span>
                                    <span>26 Feb 2025</span>
                                </div>
                                <div class="festival-item">
                                    <span>🎨 Holi</span>
                                    <span>8 Mar 2025</span>
                                </div>
                                <div class="festival-item">
                                    <span>🏹 Ram Navami</span>
                                    <span>17 Apr 2025</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Donation and Queue Tracker Row -->
                <div class="tracker-row">
                    <!-- Queue Token Tracker -->
                    <div class="widget-card">
                        <div class="widget-header-small">🎫 Your Queue Status</div>
                        <div class="widget-content-small">
                            <div id="queueTracker">
                                <div class="queue-status">
                                    <h3>Token: A-2015</h3>
                                    <div class="progress-bar">
                                        <div class="progress-fill" style="width: 60%;"></div>
                                    </div>
                                    <p>Estimated Time: <strong>45 minutes</strong></p>
                                    <p>Tokens Ahead: <strong>168</strong></p>
                                    <button class="btn btn-success btn-small" onclick="enableNotifications()">🔔 Enable Notifications</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Donation Counter -->
                    <div class="widget-card">
                        <div class="widget-header-small">💰 Today's Donations</div>
                        <div class="widget-content-small">
                            <div style="text-align: center;">
                                <div class="donation-counter" style="font-size: 2rem; font-weight: bold; color: var(--gov-green);">
                                    ₹ <span id="donationAmount">12,45,678</span>
                                </div>
                                <div style="margin: 10px 0;">
                                    <small>Total Devotees Donated: 3,456</small>
                                </div>
                                <button class="btn btn-warning btn-small" onclick="showDonationModal()">🙏 Donate Now</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tabs Section -->
                <div class="tabs">
                    <div class="tab-headers">
                        <button class="tab-header active" onclick="showTab('booking-tab')">E-Darshan Booking</button>
                        <button class="tab-header" onclick="showTab('crowd-tab')">Crowd Density Map</button>
                        <button class="tab-header" onclick="showTab('queue-tab')">Queue Management</button>
                        <button class="tab-header" onclick="showTab('parking-tab')">Parking Status</button>
                        <button class="tab-header" onclick="showTab('alerts-tab')">Alerts & Advisory</button>
                    </div>
                    
                    <div class="tab-content">
                        <!-- Booking Tab -->
                        <div id="booking-tab" class="tab-pane active">
                            <div class="gov-form">
                                <div class="form-header">E-Darshan Token Booking Form</div>
                                
                                <form onsubmit="submitBooking(event)">
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label>Select Temple <span class="required">*</span></label>
                                            <select class="form-control" required>
                                                <option value="">-- Select Temple --</option>
                                                <option>Somnath Temple</option>
                                                <option>Dwarka Temple</option>
                                                <option>Ambaji Temple</option>
                                                <option>Pavagadh Temple</option>
                                            </select>
                                        </div>
                                        
                                        <div class="form-group">
                                            <label>Darshan Type <span class="required">*</span></label>
                                            <select class="form-control" required>
                                                <option value="">-- Select Type --</option>
                                                <option>General Darshan (Free)</option>
                                                <option>Special Darshan (₹100)</option>
                                                <option>VIP Darshan (₹500)</option>
                                                <option>Senior Citizen (Free)</option>
                                                <option>Divyang (Free)</option>
                                            </select>
                                        </div>
                                        
                                        <div class="form-group">
                                            <label>Booking Type</label>
                                            <select class="form-control" onchange="toggleRecurring(this.value)">
                                                <option>Single Visit</option>
                                                <option>Group Booking (Up to 20)</option>
                                                <option>Recurring Weekly</option>
                                                <option>Recurring Monthly</option>
                                                <option>Special Occasion</option>
                                            </select>
                                        </div>
                                    </div>
                                    
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label>Preferred Date <span class="required">*</span></label>
                                            <input type="date" class="form-control" required>
                                        </div>
                                        
                                        <div class="form-group">
                                            <label>Time Slot <span class="required">*</span></label>
                                            <select class="form-control" required>
                                                <option value="">-- Select Time Slot --</option>
                                                <option>05:00 AM - 06:00 AM (Available: 150)</option>
                                                <option>06:00 AM - 07:00 AM (Available: 200)</option>
                                                <option>07:00 AM - 08:00 AM (Available: 100)</option>
                                                <option>08:00 AM - 09:00 AM (Available: 50)</option>
                                                <option>09:00 AM - 10:00 AM (Fully Booked)</option>
                                                <option>10:00 AM - 11:00 AM (Available: 75)</option>
                                                <option>11:00 AM - 12:00 PM (Available: 125)</option>
                                                <option>04:00 PM - 05:00 PM (Available: 180)</option>
                                                <option>05:00 PM - 06:00 PM (Available: 90)</option>
                                                <option>06:00 PM - 07:00 PM (Available: 40)</option>
                                                <option>07:00 PM - 08:00 PM (Available: 200)</option>
                                            </select>
                                        </div>
                                        
                                        <div class="form-group">
                                            <label>Prasad Pre-Order</label>
                                            <select class="form-control">
                                                <option>No Prasad</option>
                                                <option>Regular Prasad (₹51)</option>
                                                <option>Special Prasad (₹101)</option>
                                                <option>Premium Prasad (₹251)</option>
                                            </select>
                                        </div>
                                    </div>
                                    
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label>Full Name <span class="required">*</span></label>
                                            <input type="text" class="form-control" required>
                                        </div>
                                        
                                        <div class="form-group">
                                            <label>Mobile Number <span class="required">*</span></label>
                                            <input type="tel" class="form-control" pattern="[0-9]{10}" required>
                                        </div>
                                        
                                        <div class="form-group">
                                            <label>Email ID</label>
                                            <input type="email" class="form-control">
                                        </div>
                                    </div>
                                    
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label>Number of Devotees <span class="required">*</span></label>
                                            <input type="number" min="1" max="20" value="1" class="form-control" required onchange="updateGroupSize(this.value)">
                                        </div>
                                        
                                        <div class="form-group">
                                            <label>ID Proof Type <span class="required">*</span></label>
                                            <select class="form-control" required>
                                                <option value="">-- Select ID --</option>
                                                <option>Aadhaar Card</option>
                                                <option>PAN Card</option>
                                                <option>Voter ID</option>
                                                <option>Passport</option>
                                                <option>Driving License</option>
                                            </select>
                                        </div>
                                        
                                        <div class="form-group">
                                            <label>ID Number <span class="required">*</span></label>
                                            <input type="text" class="form-control" required>
                                        </div>
                                    </div>
                                    
                                    <!-- Payment Section -->
                                    <div class="payment-section">
                                        <h4>Payment Method</h4>
                                        <div class="payment-options">
                                            <label><input type="radio" name="payment" value="upi" checked> UPI (GPay/PhonePe/Paytm)</label>
                                            <label><input type="radio" name="payment" value="card"> Credit/Debit Card</label>
                                            <label><input type="radio" name="payment" value="netbanking"> Net Banking</label>
                                            <label><input type="radio" name="payment" value="wallet"> Digital Wallet</label>
                                        </div>
                                        <div class="total-amount">
                                            <strong>Total Amount: ₹ <span id="totalAmount">0</span></strong>
                                        </div>
                                    </div>
                                    
                                    <div style="margin-top: 20px; display: flex; gap: 10px; flex-wrap: wrap;">
                                        <button type="submit" class="btn btn-primary">Submit Booking</button>
                                        <button type="reset" class="btn btn-warning">Reset Form</button>
                                        <button type="button" class="btn btn-success" onclick="checkStatus()">Check Booking Status</button>
                                        <button type="button" class="btn btn-info" onclick="downloadTicket()">📥 Download Previous Ticket</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                        
                        <!-- Crowd Density Tab -->
                        <div id="crowd-tab" class="tab-pane">
                            <div class="density-map">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                                    <h3>Real-time Crowd Density Heatmap</h3>
                                    <div class="live-indicator">
                                        <span class="live-dot"></span>
                                        LIVE
                                    </div>
                                </div>
                                
                                <!-- Interactive Temple Map -->
                                <div class="temple-map-container">
                                    <div class="map-controls">
                                        <button onclick="zoomIn()">➕ Zoom In</button>
                                        <button onclick="zoomOut()">➖ Zoom Out</button>
                                        <button onclick="resetView()">🔄 Reset</button>
                                        <select onchange="switchFloor(this.value)">
                                            <option>Ground Floor</option>
                                            <option>First Floor</option>
                                            <option>Basement</option>
                                        </select>
                                    </div>
                                    <div id="interactiveMap" class="interactive-map">
                                        <!-- SVG or Canvas for interactive map will be rendered here -->
                                    </div>
                                </div>
                                
                                <div class="map-grid">
                                    <div class="zone-block zone-green" onclick="showZoneDetails('entry1')">
                                        <strong>Entry Gate 1</strong>
                                        <div>~250 people</div>
                                        <small>Low Density</small>
                                    </div>
                                    <div class="zone-block zone-yellow" onclick="showZoneDetails('security')">
                                        <strong>Security Check</strong>
                                        <div>~800 people</div>
                                        <small>Moderate</small>
                                    </div>
                                    <div class="zone-block zone-red" onclick="showZoneDetails('queue')">
                                        <strong>Main Queue</strong>
                                        <div>~2500 people</div>
                                        <small>High Density</small>
                                    </div>
                                    <div class="zone-block zone-orange" onclick="showZoneDetails('sanctum_entry')">
                                        <strong>Sanctum Entry</strong>
                                        <div>~1500 people</div>
                                        <small>Moderate-High</small>
                                    </div>
                                    <div class="zone-block zone-red" onclick="showZoneDetails('sanctum')">
                                        <strong>Main Sanctum</strong>
                                        <div>~3000 people</div>
                                        <small>Very High</small>
                                    </div>
                                    <div class="zone-block zone-yellow" onclick="showZoneDetails('prasad')">
                                        <strong>Prasad Counter</strong>
                                        <div>~600 people</div>
                                        <small>Moderate</small>
                                    </div>
                                    <div class="zone-block zone-green" onclick="showZoneDetails('exit1')">
                                        <strong>Exit Gate 1</strong>
                                        <div>~200 people</div>
                                        <small>Low Density</small>
                                    </div>
                                    <div class="zone-block zone-green" onclick="showZoneDetails('exit2')">
                                        <strong>Exit Gate 2</strong>
                                        <div>~150 people</div>
                                        <small>Low Density</small>
                                    </div>
                                    <div class="zone-block zone-orange" onclick="showZoneDetails('parkingA')">
                                        <strong>Parking Lot A</strong>
                                        <div>85% Full</div>
                                        <small>Limited Space</small>
                                    </div>
                                    <div class="zone-block zone-red" onclick="showZoneDetails('parkingB')">
                                        <strong>Parking Lot B</strong>
                                        <div>95% Full</div>
                                        <small>Almost Full</small>
                                    </div>
                                    <div class="zone-block zone-yellow" onclick="showZoneDetails('foodcourt')">
                                        <strong>Food Court</strong>
                                        <div>~400 people</div>
                                        <small>Moderate</small>
                                    </div>
                                    <div class="zone-block zone-green" onclick="showZoneDetails('restarea')">
                                        <strong>Rest Area</strong>
                                        <div>~100 people</div>
                                        <small>Low Density</small>
                                    </div>
                                </div>
                                
                                <div style="background: #f5f5f5; padding: 15px; margin-top: 20px; border: 1px solid var(--gov-border);">
                                    <strong>🤖 AI Predictions for Next 2 Hours:</strong>
                                    <ul style="margin: 10px 0 0 20px;">
                                        <li>Expected 25% increase in crowd by 12:00 PM</li>
                                        <li>Parking Lot B likely to be full in 30 minutes</li>
                                        <li>Recommended to open Emergency Gate 3 by 11:30 AM</li>
                                        <li>Deploy additional security at Main Queue area</li>
                                    </ul>
                                    <button class="btn btn-primary btn-small" onclick="showAIAnalytics()">View Detailed AI Analytics</button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Queue Management Tab -->
                        <div id="queue-tab" class="tab-pane">
                            <div class="token-display">
                                <div style="font-size: 1.2rem;">Current Token Being Served</div>
                                <div class="current-token">A-1847</div>
                                <div class="token-info">
                                    <div>
                                        <div style="font-size: 0.9rem; opacity: 0.8;">Your Token</div>
                                        <div style="font-size: 1.5rem; font-weight: bold;">A-2015</div>
                                    </div>
                                    <div>
                                        <div style="font-size: 0.9rem; opacity: 0.8;">Estimated Time</div>
                                        <div style="font-size: 1.5rem; font-weight: bold;">45 min</div>
                                    </div>
                                    <div>
                                        <div style="font-size: 0.9rem; opacity: 0.8;">Tokens Ahead</div>
                                        <div style="font-size: 1.5rem; font-weight: bold;">168</div>
                                    </div>
                                </div>
                            </div>
                            
                            <h4 style="margin: 20px 0;">Queue Statistics</h4>
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Queue Type</th>
                                        <th>Current Token</th>
                                        <th>Last Token</th>
                                        <th>Avg. Wait Time</th>
                                        <th>People Waiting</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td data-label="Queue Type">General Darshan</td>
                                        <td data-label="Current Token">A-1847</td>
                                        <td data-label="Last Token">A-3500</td>
                                        <td data-label="Avg. Wait Time">45 min</td>
                                        <td data-label="People Waiting">1,653</td>
                                        <td data-label="Status"><span style="color: var(--gov-orange);">Moderate</span></td>
                                    </tr>
                                    <tr>
                                        <td data-label="Queue Type">Special Darshan</td>
                                        <td data-label="Current Token">B-425</td>
                                        <td data-label="Last Token">B-800</td>
                                        <td data-label="Avg. Wait Time">20 min</td>
                                        <td data-label="People Waiting">375</td>
                                        <td data-label="Status"><span style="color: var(--gov-green);">Fast Moving</span></td>
                                    </tr>
                                    <tr>
                                        <td data-label="Queue Type">VIP Darshan</td>
                                        <td data-label="Current Token">V-85</td>
                                        <td data-label="Last Token">V-150</td>
                                        <td data-label="Avg. Wait Time">10 min</td>
                                        <td data-label="People Waiting">65</td>
                                        <td data-label="Status"><span style="color: var(--gov-green);">Quick</span></td>
                                    </tr>
                                    <tr>
                                        <td data-label="Queue Type">Senior Citizen</td>
                                        <td data-label="Current Token">S-210</td>
                                        <td data-label="Last Token">S-400</td>
                                        <td data-label="Avg. Wait Time">25 min</td>
                                        <td data-label="People Waiting">190</td>
                                        <td data-label="Status"><span style="color: var(--gov-green);">Priority</span></td>
                                    </tr>
                                    <tr>
                                        <td data-label="Queue Type">Divyang</td>
                                        <td data-label="Current Token">D-45</td>
                                        <td data-label="Last Token">D-100</td>
                                        <td data-label="Avg. Wait Time">15 min</td>
                                        <td data-label="People Waiting">55</td>
                                        <td data-label="Status"><span style="color: var(--gov-green);">Priority</span></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        
                        <!-- Parking Tab -->
                        <div id="parking-tab" class="tab-pane">
                            <h4>🚗 Real-time Parking Availability</h4>
                            
                            <div class="parking-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px; margin: 20px 0;">
                                <div class="parking-card">
                                    <h5>Parking Lot A (Main Gate)</h5>
                                    <div class="parking-stats">
                                        <div class="stat-row">
                                            <span>Total Capacity:</span>
                                            <strong>1000</strong>
                                        </div>
                                        <div class="stat-row">
                                            <span>Occupied:</span>
                                            <strong class="text-danger">850</strong>
                                        </div>
                                        <div class="stat-row">
                                            <span>Available:</span>
                                            <strong class="text-success">150</strong>
                                        </div>
                                        <div class="progress-bar">
                                            <div class="progress-fill" style="width: 85%;"></div>
                                        </div>
                                        <small>Rate: ₹20/hour | Distance: 500m</small>
                                    </div>
                                </div>
                                
                                <div class="parking-card">
                                    <h5>Parking Lot B (East Gate)</h5>
                                    <div class="parking-stats">
                                        <div class="stat-row">
                                            <span>Total Capacity:</span>
                                            <strong>800</strong>
                                        </div>
                                        <div class="stat-row">
                                            <span>Occupied:</span>
                                            <strong class="text-danger">760</strong>
                                        </div>
                                        <div class="stat-row">
                                            <span>Available:</span>
                                            <strong class="text-warning">40</strong>
                                        </div>
                                        <div class="progress-bar">
                                            <div class="progress-fill danger" style="width: 95%;"></div>
                                        </div>
                                        <small>Rate: ₹15/hour | Distance: 800m</small>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="alert alert-info">
                                <strong>ℹ️ Shuttle Service:</strong> Free shuttle buses available from all parking lots to temple main gate. Frequency: Every 10 minutes.
                            </div>
                        </div>
                        
                        <!-- Alerts Tab -->
                        <div id="alerts-tab" class="tab-pane">
                            <h4>📢 Important Alerts & Advisories</h4>
                            
                            <div class="alert alert-danger">
                                <strong>🚨 URGENT:</strong> Heavy rush expected this weekend due to Ekadashi. Please book your slots in advance.
                            </div>
                            
                            <div class="alert alert-warning">
                                <strong>⚠️ TRAFFIC ADVISORY:</strong> Main approach road will be closed for VIP movement from 10:00 AM to 11:00 AM tomorrow.
                            </div>
                            
                            <div class="alert alert-info">
                                <strong>ℹ️ SPECIAL DARSHAN:</strong> Mangla Aarti at 4:30 AM. Limited slots available.
                            </div>
                            
                            <h4 style="margin-top: 30px;">📋 Guidelines for Devotees</h4>
                            <ol style="margin-left: 20px; line-height: 1.8;">
                                <li>Carry valid ID proof matching your booking details</li>
                                <li>Arrive 30 minutes before your scheduled slot</li>
                                <li>Mobile phones allowed but keep on silent mode</li>
                                <li>Photography prohibited inside main sanctum</li>
                                <li>Dress code: Traditional/Decent clothing mandatory</li>
                            </ol>
                        </div>
                    </div>
                </div>

                <!-- Emergency Services -->
                <div class="emergency-services">
                    <h4>🚨 Emergency Services</h4>
                    <div class="emergency-grid">
                        <div>
                            <strong>🏥 Medical Emergency:</strong><br>
                            📞 108 (Ambulance)<br>
                            Temple Dispensary: 02876-XXXXX
                        </div>
                        <div>
                            <strong>👮 Security/Police:</strong><br>
                            📞 100 (Police)<br>
                            Control Room: 02876-XXXXX
                        </div>
                        <div>
                            <strong>🔥 Fire Emergency:</strong><br>
                            📞 101 (Fire Brigade)<br>
                            Temple Safety: 02876-XXXXX
                        </div>
                        <div>
                            <strong>📞 Temple Helpline:</strong><br>
                            Toll Free: 1800-XXX-XXXX<br>
                            WhatsApp: 98765-XXXXX
                        </div>
                    </div>
                </div>

                <!-- Action and Facility Row - Below Emergency Services -->
                <div class="action-facility-row">
                    <!-- Quick Actions Widget -->
                    <div class="widget-card">
                        <div class="widget-header-small">⚡ Quick Actions</div>
                        <div class="widget-content-small">
                            <button class="btn btn-primary btn-small" onclick="downloadApp()">📱 DOWNLOAD MOBILE APP</button>
                            <button class="btn btn-success btn-small" onclick="virtualTour()">🎥 360° VIRTUAL TOUR</button>
                            <button class="btn btn-warning btn-small" onclick="printToken()">🖨️ PRINT E-TOKEN</button>
                            <button class="btn btn-danger btn-small" onclick="reportIssue()">📢 REPORT ISSUE</button>
                        </div>
                    </div>
                    
                    <!-- Facilities Status Widget -->
                    <div class="widget-card">
                        <div class="widget-header-small">🏛️ Facilities Status</div>
                        <div class="widget-content-small">
                            <div class="facility-grid">
                                <div class="facility-item">
                                    <span>🚻 Washrooms</span>
                                    <span class="text-success">✓ Available</span>
                                </div>
                                <div class="facility-item">
                                    <span>💧 Drinking Water</span>
                                    <span class="text-success">✓ Available</span>
                                </div>
                                <div class="facility-item">
                                    <span>👟 Shoe Stand</span>
                                    <span class="text-warning">70% Full</span>
                                </div>
                                <div class="facility-item">
                                    <span>🍽️ Food Court</span>
                                    <span class="text-success">✓ Open</span>
                                </div>
                                <div class="facility-item">
                                    <span>🏥 First Aid</span>
                                    <span class="text-success">✓ Available</span>
                                </div>
                                <div class="facility-item">
                                    <span>♿ Wheelchair</span>
                                    <span class="text-success">✓ 15 Available</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>

            <!-- Right Sidebar - Removed since widgets are now integrated in main content -->
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="footer-top">
            <div class="footer-grid">
                <div class="footer-section">
                    <h4>About SmartPilgrim</h4>
                    <ul>
                        <li><a href="#">About Us</a></li>
                        <li><a href="#">Our Mission</a></li>
                        <li><a href="#">Temple History</a></li>
                        <li><a href="#">Technology Partners</a></li>
                        <li><a href="#">Awards & Recognition</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h4>Services</h4>
                    <ul>
                        <li><a href="#">E-Darshan Booking</a></li>
                        <li><a href="#">Virtual Queue</a></li>
                        <li><a href="#">Live Crowd Status</a></li>
                        <li><a href="#">Parking Services</a></li>
                        <li><a href="#">Online Donation</a></li>
                        <li><a href="#">Special Assistance</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h4>Resources</h4>
                    <ul>
                        <li><a href="#">User Manual</a></li>
                        <li><a href="#">Video Tutorials</a></li>
                        <li><a href="#">FAQs</a></li>
                        <li><a href="#">Mobile App</a></li>
                        <li><a href="#">API Documentation</a></li>
                        <li><a href="#">RTI</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h4>Contact</h4>
                    <ul>
                        <li>📞 Toll Free: 1800-XXX-XXXX</li>
                        <li>📧 Email: support@smartpilgrim.gujarat.gov.in</li>
                        <li>💬 WhatsApp: 98765-XXXXX</li>
                        <li>📍 Address: GUJCOST, Gandhinagar</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <div class="footer-bottom">
            <div>© 2025 SmartPilgrim - Government of Gujarat | All Rights Reserved</div>
            <div style="margin-top: 10px;">
                <a href="#" style="color: white; margin: 0 10px;">Privacy Policy</a> |
                <a href="#" style="color: white; margin: 0 10px;">Terms of Service</a> |
                <a href="#" style="color: white; margin: 0 10px;">Disclaimer</a> |
                <a href="#" style="color: white; margin: 0 10px;">Accessibility</a> |
                <a href="#" style="color: white; margin: 0 10px;">Site Map</a>
            </div>
            <div style="margin-top: 10px; font-size: 0.9rem;">
                Visitor Count: <strong>12,45,678</strong> | Last Updated: <strong>22/09/2025 10:45 AM</strong>
            </div>
        </div>
    </footer>

    <!-- Emergency Modal -->
    <div id="emergencyModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>🚨 Emergency Assistance</h3>
                <span class="modal-close" onclick="closeModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div class="alert alert-danger">
                    <strong>For immediate emergency, call 108 (Medical) or 100 (Police)</strong>
                </div>
                
                <button class="panic-btn" onclick="panicButton()">🆘 PANIC BUTTON - Send Location</button>
                
                <h4>Report Emergency:</h4>
                <form>
                    <div class="form-group" style="margin-bottom: 15px;">
                        <label>Emergency Type <span class="required">*</span></label>
                        <select class="form-control" required>
                            <option value="">-- Select Type --</option>
                            <option>Medical Emergency</option>
                            <option>Security Threat</option>
                            <option>Fire Incident</option>
                            <option>Stampede Risk</option>
                            <option>Lost Person</option>
                            <option>Other</option>
                        </select>
                    </div>
                    
                    <div class="form-group" style="margin-bottom: 15px;">
                        <label>Your Location <span class="required">*</span></label>
                        <select class="form-control" required>
                            <option value="">-- Select Location --</option>
                            <option>Main Gate</option>
                            <option>Queue Area</option>
                            <option>Inside Temple</option>
                            <option>Parking Area</option>
                            <option>Food Court</option>
                            <option>Exit Gate</option>
                        </select>
                    </div>
                    
                    <div class="form-group" style="margin-bottom: 15px;">
                        <label>Mobile Number <span class="required">*</span></label>
                        <input type="tel" class="form-control" pattern="[0-9]{10}" required>
                    </div>
                    
                    <div class="form-group" style="margin-bottom: 15px;">
                        <label>Description</label>
                        <textarea class="form-control" rows="3"></textarea>
                    </div>
                    
                    <button type="submit" class="btn btn-danger">Send Emergency Alert</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Login Modal -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>🔐 Login / Register</h3>
                <span class="modal-close" onclick="closeLoginModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div class="tab-headers">
                    <button class="tab-header active" onclick="showLoginTab('login')">Login</button>
                    <button class="tab-header" onclick="showLoginTab('register')">Register</button>
                    <button class="tab-header" onclick="showLoginTab('otp')">Login with OTP</button>
                </div>
                
                <div id="login-tab" class="login-tab active">
                    <form onsubmit="performLogin(event)">
                        <div class="form-group">
                            <label>Mobile Number / Email</label>
                            <input type="text" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Password</label>
                            <input type="password" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label><input type="checkbox"> Remember me</label>
                        </div>
                        <button type="submit" class="btn btn-primary">Login</button>
                        <a href="#" onclick="forgotPassword()">Forgot Password?</a>
                    </form>
                </div>
                
                <div id="register-tab" class="login-tab" style="display: none;">
                    <form onsubmit="performRegister(event)">
                        <div class="form-group">
                            <label>Full Name</label>
                            <input type="text" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Mobile Number</label>
                            <input type="tel" class="form-control" pattern="[0-9]{10}" required>
                        </div>
                        <div class="form-group">
                            <label>Email</label>
                            <input type="email" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Password</label>
                            <input type="password" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Aadhaar Number (Optional)</label>
                            <input type="text" class="form-control" pattern="[0-9]{12}">
                        </div>
                        <button type="submit" class="btn btn-primary">Register</button>
                    </form>
                </div>
                
                <div id="otp-tab" class="login-tab" style="display: none;">
                    <form onsubmit="sendOTP(event)">
                        <div class="form-group">
                            <label>Mobile Number</label>
                            <input type="tel" class="form-control" pattern="[0-9]{10}" required>
                        </div>
                        <button type="submit" class="btn btn-primary">Send OTP</button>
                        <div class="form-group" id="otpInput" style="display: none; margin-top: 15px;">
                            <label>Enter OTP</label>
                            <input type="text" class="form-control" pattern="[0-9]{6}">
                            <button type="button" class="btn btn-success" onclick="verifyOTP()">Verify OTP</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Donation Modal -->
    <div id="donationModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>🙏 Online Donation</h3>
                <span class="modal-close" onclick="closeDonationModal()">&times;</span>
            </div>
            <div class="modal-body">
                <form onsubmit="processDonation(event)">
                    <div class="form-group">
                        <label>Donation Category</label>
                        <select class="form-control" onchange="updateDonationAmount(this.value)">
                            <option value="annadaan">Annadaan (₹501)</option>
                            <option value="maintenance">Temple Maintenance (₹1001)</option>
                            <option value="pooja">Special Pooja (₹2501)</option>
                            <option value="development">Temple Development (₹5001)</option>
                            <option value="custom">Custom Amount</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>Amount (₹)</label>
                        <input type="number" id="donationAmount" class="form-control" value="501" min="1" required>
                    </div>
                    
                    <div class="form-group">
                        <label>Donor Name</label>
                        <input type="text" class="form-control" required>
                    </div>
                    
                    <div class="form-group">
                        <label>Mobile Number</label>
                        <input type="tel" class="form-control" pattern="[0-9]{10}" required>
                    </div>
                    
                    <div class="form-group">
                        <label>PAN Number (For 80G Certificate)</label>
                        <input type="text" class="form-control" pattern="[A-Z]{5}[0-9]{4}[A-Z]{1}">
                    </div>
                    
                    <div class="payment-options">
                        <h4>Select Payment Method:</h4>
                        <div class="payment-grid">
                            <button type="button" class="payment-btn" onclick="payWithUPI()">
                                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' fill='%23008000'/%3E%3Ctext x='50' y='50' text-anchor='middle' fill='white' font-size='20'%3EUPI%3C/text%3E%3C/svg%3E" alt="UPI">
                                UPI Payment
                            </button>
                            <button type="button" class="payment-btn" onclick="payWithCard()">
                                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' fill='%234169E1'/%3E%3Ctext x='50' y='50' text-anchor='middle' fill='white' font-size='20'%3ECARD%3C/text%3E%3C/svg%3E" alt="Card">
                                Card Payment
                            </button>
                            <button type="button" class="payment-btn" onclick="payWithNetBanking()">
                                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' fill='%23FF6347'/%3E%3Ctext x='50' y='50' text-anchor='middle' fill='white' font-size='20'%3EBANK%3C/text%3E%3C/svg%3E" alt="Bank">
                                Net Banking
                            </button>
                        </div>
                    </div>
                    
                    <button type="submit" class="btn btn-success">Proceed to Pay</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Live Camera Modal -->
    <div id="liveCamModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3>📹 Live Camera Feed</h3>
                <span class="modal-close" onclick="closeLiveCam()">&times;</span>
            </div>
            <div class="modal-body">
                <select onchange="switchCamera(this.value)">
                    <option>Main Entrance</option>
                    <option>Queue Area</option>
                    <option>Sanctum Exterior</option>
                    <option>Parking Lot A</option>
                    <option>Parking Lot B</option>
                    <option>Food Court</option>
                </select>
                <div class="video-container" style="margin-top: 15px;">
                    <video id="liveFeed" width="100%" height="400" controls autoplay>
                        <source src="live-feed.mp4" type="video/mp4">
                        Your browser does not support video.
                    </video>
                </div>
                <div style="margin-top: 10px;">
                    <small>🔴 Live | Viewers: 234 | Camera: CAM-001</small>
                </div>
            </div>
        </div>
    </div>


    <!-- Floating Chatbot Icon -->
    <div id="chatbotIcon" class="chatbot-icon" onclick="toggleChatbot()">
        💬
    </div>

    <!-- Floating Chatbot Window -->
    <div class="chatbot-container" id="chatbot">
        <div class="chatbot-header">
            <span>🤖 Temple Assistant</span>
        </div>
        <div class="chatbot-body">
            <div class="chatbot-messages" id="chatMessages">
                <div class="bot-message">
                    <p>Namaste! 🙏 I'm your temple assistant. How can I help you today?</p>
                </div>
            </div>
            <div class="chatbot-input">
                <input type="text" id="chatInput" placeholder="Type your message..." onkeypress="sendChatMessage(event)">
                <button onclick="sendMessage()">Send</button>
            </div>
        </div>
    </div>



    <!-- QR Scanner (for mobile) -->
    <div id="qrScanner" style="display: none;">
        <div class="scanner-container">
            <h3>Scan QR Code for Entry</h3>
            <div id="qrReader"></div>
            <button onclick="closeQRScanner()">Close Scanner</button>
        </div>
    </div>

    <!-- Accessibility Button -->
    <button class="accessibility-btn" onclick="toggleAccessibility()" title="Accessibility Options">♿</button>

    <!-- Voice Assistant Button -->
    <button class="voice-btn" onclick="startVoiceAssistant()" title="Voice Assistant">🎤</button>

    <!-- Include JavaScript -->
    <script src="script.js"></script>
    
    <!-- Service Worker Registration with Error Handling -->
    <script>
        // Only register service worker if running on a proper web server
        if ('serviceWorker' in navigator && window.location.protocol === 'https:') {
            // Check if we're on a real domain (not claudeusercontent or local preview)
            if (!window.location.hostname.includes('claudeusercontent') && 
                !window.location.hostname.includes('localhost') &&
                !window.location.hostname.includes('127.0.0.1')) {
                
                navigator.serviceWorker.register('sw.js').then(function(registration) {
                    console.log('Service Worker registered with scope:', registration.scope);
                }).catch(function(error) {
                    console.log('Service Worker registration failed:', error);
                    // Silently fail - the app will work without offline support
                });
            } else {
                console.log('Service Worker not registered - running in development/preview mode');
            }
        } else {
            console.log('Service Worker not supported or not on HTTPS');
        }
    </script>
</body>
</html>
